model Product {
  id          String    @id @default(uuid())
  name        String
  slug        String    @unique
  description   String?
  country    String?
  salesCount    Int              @default(0)
  isNew         Boolean          @default(false)
  isFeatured    Boolean          @default(false)
  isTrending    Boolean          @default(false)
  isBestSeller  Boolean          @default(false)
  averageRating Float            @default(0)
  reviewCount   Int              @default(0)
  brandId     String
  categoryId  String
  thumbleImage String?
  price       Float
  discount    Float?
  stock       Int
  shortDesc   String?
  faquestions  String?
  longDesc    String?
  isActive    Boolean  @default(true)
  brand       Brand    @relation(fields: [brandId], references: [id],onDelete: Cascade)
  category    Category @relation(fields: [categoryId], references: [id],onDelete: Cascade)
  variants    ProductVariant[]
  reviews     Review[]
  tag           Tag[]
  ingredients ProductIngredient[]
  concerns    ProductSkinConcern[]
  interactions  Interaction[]
  skinTypes   ProductSkinType[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  @@index([name, slug, brandId, categoryId, isActive, isFeatured, isTrending, isBestSeller])
}

model ProductVariant {
  id        String   @id @default(uuid())
  productId String
  sku               String @unique
  size      String
  images            String[] 
  price     Float?
  stock     Int?
  lowStockThreshold Int @default(10)
  attributes        ProductVariantAttribute[]
  cartItems         CartItem[]
  stockMovements    StockMovement[]
  restocks          Restock[]
  product   Product  @relation(fields: [productId], references: [id],onDelete: Cascade)
  orderItems OrderItem[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

}
model Attribute {
  id                String                    @id @default(uuid())
  name              String                    @unique
  slug              String                    @unique
  values            AttributeValue[]
  categories        CategoryAttribute[]
  variantAttributes ProductVariantAttribute[]
  createdAt         DateTime                  @default(now())
  updatedAt         DateTime                  @updatedAt

  @@index([name, slug])
  
}

model AttributeValue {
  id                String                    @id @default(uuid())
  attributeId       String
  attribute         Attribute                 @relation(fields: [attributeId], references: [id], onDelete: Cascade)
  value             String
  slug              String                    @unique
  variantAttributes ProductVariantAttribute[]
  createdAt         DateTime                  @default(now())
  updatedAt         DateTime                  @updatedAt

  @@index([attributeId, value])
}

model ProductVariantAttribute {
  id          String         @id @default(uuid())
  variantId   String
  variant     ProductVariant @relation(fields: [variantId], references: [id], onDelete: Cascade)
  attributeId String
  attribute   Attribute      @relation(fields: [attributeId], references: [id], onDelete: Cascade)
  valueId     String
  value       AttributeValue @relation(fields: [valueId], references: [id], onDelete: Cascade)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt

  @@unique([variantId, attributeId, valueId])
  @@index([variantId, attributeId])
}



model Ingredient {
  id          String       @id @default(uuid())
  name        String
  description String?       
  benefits    String?     
  sideEffects String?       
  usage       String?     
  precautions String?       
  isActive    Boolean       @default(true) 
  safetyLevel SafetyLevel
  products    ProductIngredient[] 
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}


model ProductIngredient {
  productId    String
  ingredientId String

  product      Product    @relation(fields: [productId], references: [id],onDelete: Cascade)
  ingredient   Ingredient @relation(fields: [ingredientId], references: [id],onDelete: Cascade)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt

  @@id([productId, ingredientId])
}




